"use strict";(function(){var e=["elevator.jpg","hand.png","last-1.png","last-2.png","last-3.png","last-4.png","last-5.png","light-by.png","light-sp.png","light-ss.png","light-sy.png","light-sz.png","light-tc.png","modal-lottery.png","modal-que-by.png","modal-que-sp.png","modal-que-ss.png","modal-que-sy.png","modal-que-sz.png","modal-que-tc.png","modal-tip.png","right.png","wrong.png"],t=document.getElementById("bgm-c"),n=document.getElementById("bgm-gk"),o=document.getElementById("bgm-hp"),i=document.getElementById("bgm-rsj"),a=document.getElementById("bgm-tx"),s=document.getElementById("bgm-td"),u=document.getElementById("bgm-xp");t.play(),t.pause(),document.addEventListener("WeixinJSBridgeReady",function(){t.play(),t.pause()},!1);var l=function(){function e(){h.currentTime=17}function l(){requestAnimationFrame(function(){if(h.currentTime>=25)return h.pause(),$(".page-video").addClass("opacity"),$(".page-pano").addClass("opacity").show(),setTimeout(function(){$(".page-pano").removeClass("opacity")}),setTimeout(function(){$(".page-video").hide()},320),t.play(),void(f=!0);h.currentTime>=17?h.removeEventListener("click",e):h.currentTime>=7&&h.addEventListener("click",e,{once:!0}),l()})}function d(){if(w.addClass("active"+v),b&&(L++,T=Math.floor(c(L,50,500,q)),L==q))return b=!1,void setTimeout(function(){E=!0,$(".modal-lottery").hide()},1e3);setTimeout(function(){w.removeClass("active"+v),v++,5===v&&(v=0),d()},T)}function c(e,t,n,o){return n*(e/=o)*e*e*e*e+t}function r(e,t){return e>t?e-t:e<t?5-t+e:0}function p(){E&&(E=!1,b=!1,C=0,q=0,L=0,T=50,d())}function g(){E||b||(C=Math.floor(5*Math.random()),b=!0,q=r(C,v)+5)}var m,f=!1;$(".orientLayer").on("touchstart",function(){return!1});var h=document.getElementById("video");h.addEventListener("click",function(){h.paused&&h.play()}),$(".startLayer").on("click",function(){$(this).hide(),$(".page-video").addClass("opacity").show(),setTimeout(function(){$(".page-video").removeClass("opacity")},20),h.play(),l()}),h.addEventListener("ended",function(){console.log("end")}),embedpano({swf:"tour.swf",xml:"tour.xml",target:"pano",html5:"auto",mobilescale:1,passQueryParameters:!0,consolelog:!0,onready:function(e){m=e}}),window.inCorridor=function(){n.pause(),o.pause(),i.pause(),a.pause(),s.pause(),u.pause(),f&&t.play()},window.inGK=function(){t.pause(),n.play()},window.inRSJ=function(){t.pause(),i.play()},window.inTX=function(){t.pause(),a.play()},window.inHP=function(){t.pause(),o.play()},window.inXP=function(){t.pause(),u.play()};var y=0;window.inTD=function(){t.pause(),s.play(),setTimeout(function(){$(".modal-tip").show()},1e3),y=0},window.openQue=function(e){$(".modal-que-"+e).show()},$(".modal-tip").click(function(){$(this).hide()}),$(".modal-que .answer").click(function(){var e=this,t=$(this).attr("data-right");t?($(this).addClass("right"),setTimeout(function(){$(e).removeClass("right"),$(".modal-que").hide(),m.call("set(hotspot[light-"+t+"].visible,false);"),y++,6===y?$(".modal-lottery").show():($(".last-"+(6-y)).show(),setTimeout(function(){$(".last-"+(6-y)).hide()},1e3))},1e3)):($(this).addClass("wrong"),setTimeout(function(){$(e).removeClass("wrong")},1e3))}),$(".btn-lottery").click(function(){E&&(p(),setTimeout(function(){g()},2e3))});var v=0,w=$(".active"),T=50,b=!1,E=!0,C=0,q=0,L=0};!function(t){function n(e){console.log("error:",e)}function o(e){var t=100*a.progress;$(".loadingLayout .count").text(t.toFixed()+"%")}function i(){$(".loadingLayout").hide(),t()}if(0==e.length)return void i();var a=new createjs.LoadQueue(!1,"./assets/");a.on("error",n),a.on("progress",o),a.on("complete",i);for(var s=0;s<e.length;s++)a.loadFile(e[s])}(function(){l()})}).call(void 0);