"use strict";(function(){function t(t,o){for(var n in o)window[t+"_"+n]=o[n]}var o=["gk/last-1.png","gk/last-2.png","gk/last-3.png","gk/light-1.png","gk/light-2.png","gk/light-3.png","gk/light-4.png","gk/modal-gift-1.png","gk/modal-gift-2.png","gk/modal-gift-3.png","gk/modal-gift-4.png","gk/modal-gift-5.png","gk/modal-hotspot-1.png","gk/modal-hotspot-2.png","gk/modal-hotspot-3.png","gk/modal-hotspot-4.png","gk/modal-lottery.png","gk/modal-start.png","hp/last-1.png","hp/last-2.png","hp/last-3.png","hp/light-1.png","hp/light-2.png","hp/light-3.png","hp/light-4.png","hp/modal-gift-1.png","hp/modal-gift-2.png","hp/modal-gift-3.png","hp/modal-gift-4.png","hp/modal-gift-5.png","hp/modal-hotspot-1.png","hp/modal-hotspot-2.png","hp/modal-hotspot-3.png","hp/modal-hotspot-4.png","hp/modal-lottery.png","hp/modal-start.png","right.png","rsj/last-1.png","rsj/last-2.png","rsj/last-3.png","rsj/light-1.png","rsj/light-2.png","rsj/light-3.png","rsj/light-4.png","rsj/modal-gift-1.png","rsj/modal-gift-2.png","rsj/modal-gift-3.png","rsj/modal-gift-4.png","rsj/modal-gift-5.png","rsj/modal-hotspot-1.png","rsj/modal-hotspot-2.png","rsj/modal-hotspot-3.png","rsj/modal-hotspot-4.png","rsj/modal-lottery.png","rsj/modal-start.png","td/last-1.png","td/last-2.png","td/last-3.png","td/last-4.png","td/last-5.png","td/light-by.png","td/light-sp.png","td/light-ss.png","td/light-sy.png","td/light-sz.png","td/light-tc.png","td/modal-gift-1.png","td/modal-gift-2.png","td/modal-gift-3.png","td/modal-gift-4.png","td/modal-gift-5.png","td/modal-hotspot-by.png","td/modal-hotspot-sp.png","td/modal-hotspot-ss.png","td/modal-hotspot-sy.png","td/modal-hotspot-sz.png","td/modal-hotspot-tc.png","td/modal-lottery.png","td/modal-start.png","tx/last-1.png","tx/last-2.png","tx/last-3.png","tx/light-1.png","tx/light-2.png","tx/light-3.png","tx/light-4.png","tx/modal-gift-1.png","tx/modal-gift-2.png","tx/modal-gift-3.png","tx/modal-gift-4.png","tx/modal-gift-5.png","tx/modal-hotspot-1.png","tx/modal-hotspot-2.png","tx/modal-hotspot-3.png","tx/modal-hotspot-4.png","tx/modal-lottery.png","tx/modal-start.png","tx/scratch.png","tx/tv.png","wrong.png","xp/last-1.png","xp/last-2.png","xp/last-3.png","xp/light-1.png","xp/light-2.png","xp/light-3.png","xp/light-4.png","xp/modal-gift-1.png","xp/modal-gift-2.png","xp/modal-gift-3.png","xp/modal-gift-4.png","xp/modal-gift-5.png","xp/modal-hotspot-1.png","xp/modal-hotspot-2.png","xp/modal-hotspot-3.png","xp/modal-hotspot-4.png","xp/modal-lottery.png","xp/modal-start.png"],n=function(t){function o(){if(d.addClass("active"+s),g&&(h++,p=Math.floor(n(h,50,500,c)),h==c))return g=!1,void setTimeout(function(){m=!0,l(".modal-lottery").hide(),l(".modal-gift").addClass("modal-gift-"+u).show()},1e3);setTimeout(function(){d.removeClass("active"+s),s++,5===s&&(s=0),o()},p)}function n(t,o,n,a){return n*(t/=a)*t*t*t*t+o}function a(t,o){return t>o?t-o:t<o?5-o+t:0}function i(){m&&(m=!1,g=!1,u=r=0,c=0,h=0,p=50,o())}function e(){m||g||(u=Math.floor(5*Math.random())+1,r=u-1,g=!0,c=a(r,s)+5)}var s=0,l=t.find.bind(t),d=l(".active"),p=50,g=!1,m=!0,r=0,c=0,h=0,u=0;l(".btn-lottery").click(function(){m&&(i(),setTimeout(function(){e()},2e3))})},a=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-gk"),i=$(".room-gk"),e=i.find.bind(i),s=0,l=!1;e(".modal-start .btn-start").click(function(){e(".modal-start").hide()}),e(".modal-hotspot .answer").click(function(){var t=this;if(!l){l=!0;var o=$(this).attr("data-right");o?($(this).addClass("right"),setTimeout(function(){$(t).removeClass("right"),e(".modal-hotspot").hide(),window.krpanoInstance.call("set(hotspot[room-gk-light-"+o+"].visible,false);"),s++,4===s?e(".modal-lottery").show():(e(".last-"+(4-s)).show(),setTimeout(function(){e(".last-"+(4-s)).hide(),l=!1},1e3))},1e3)):($(this).addClass("wrong"),setTimeout(function(){$(t).removeClass("wrong"),l=!1},1e3))}}),e(".modal-gift .btn-book").click(function(){e(".modal-gift").hide()}),n(i),t("gk",{in:function(){o.pause(),a.play(),setTimeout(function(){e(".modal-start").show()},1e3),s=0},openHotspot:function(t){e(".modal-hotspot-"+t).show()}})},i=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-hp"),i=$(".room-hp"),e=i.find.bind(i),s=0;e(".modal-start .btn-start").click(function(){e(".modal-start").hide()}),e(".modal-hotspot").click(function(){$(this).hide();var t=$(this).attr("data-hotspot");window.krpanoInstance.call("set(hotspot[room-hp-light-"+t+"].visible,false);"),4===s?e(".modal-lottery").show():(e(".last-"+(4-s)).show(),setTimeout(function(){e(".last-"+(4-s)).hide()},1e3))}),e(".modal-gift .btn-book").click(function(){e(".modal-gift").hide()}),n(i),t("hp",{in:function(){o.pause(),a.play(),setTimeout(function(){e(".modal-start").show()},1e3),s=0},openHotspot:function(t){e(".modal-hotspot-"+t).show(),s++}})},e=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-rsj"),i=$(".room-rsj"),e=i.find.bind(i),s=0;e(".modal-start .btn-start").click(function(){e(".modal-start").hide()}),e(".modal-hotspot").click(function(){$(this).hide();var t=$(this).attr("data-hotspot");window.krpanoInstance.call("set(hotspot[room-rsj-light-"+t+"].visible,false);"),4===s?e(".modal-lottery").show():(e(".last-"+(4-s)).show(),setTimeout(function(){e(".last-"+(4-s)).hide()},1e3))}),e(".modal-gift .btn-book").click(function(){e(".modal-gift").hide()}),n(i),t("rsj",{in:function(){o.pause(),a.play(),setTimeout(function(){e(".modal-start").show()},1e3),s=0},openHotspot:function(t){e(".modal-hotspot-"+t).show(),s++}})},s=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-td"),i=$(".room-td"),e=i.find.bind(i),s=0,l=!1;e(".modal-start .btn-start").click(function(){e(".modal-start").hide()}),e(".modal-hotspot .answer").click(function(){var t=this;if(!l){l=!0;var o=$(this).attr("data-right");o?($(this).addClass("right"),setTimeout(function(){$(t).removeClass("right"),e(".modal-hotspot").hide(),window.krpanoInstance.call("set(hotspot[room-td-light-"+o+"].visible,false);"),s++,3===s?e(".modal-lottery").show():(e(".last-"+(3-s)).show(),setTimeout(function(){e(".last-"+(3-s)).hide(),l=!1},1e3))},1e3)):($(this).addClass("wrong"),setTimeout(function(){$(t).removeClass("wrong"),l=!1},1e3))}}),e(".modal-gift .btn-book").click(function(){e(".modal-gift").hide()}),n(i),t("td",{in:function(){o.pause(),a.play(),setTimeout(function(){e(".modal-start").show()},1e3),s=0},openHotspot:function(t){e(".modal-hotspot-"+t).show()}})},l=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-tx"),i=$(".room-tx"),e=i.find.bind(i),s=0,l=!1;e(".modal-start .btn-start").click(function(){e(".modal-start").hide()}),e(".modal-hotspot").click(function(){if(l){$(this).hide();var t=$(this).attr("data-hotspot");window.krpanoInstance.call("set(hotspot[room-tx-light-"+t+"].visible,false);"),$(this).find(".cover").eraser("reset"),4===s?e(".modal-lottery").show():(e(".last-"+(4-s)).show(),setTimeout(function(){e(".last-"+(4-s)).hide()},1e3))}}),e(".modal-gift .btn-book").click(function(){e(".modal-gift").hide()}),n(i),t("tx",{in:function(){o.pause(),a.play(),setTimeout(function(){e(".modal-start").show()},1e3),s=0},openHotspot:function(t){l=!1,e(".modal-hotspot-"+t).show(),e(".modal-hotspot-"+t).find(".cover").show(),e(".modal-hotspot-"+t).find(".cover").eraser({progressFunction:function(o){Math.round(100*o)>60&&(e(".modal-hotspot-"+t).find(".cover").eraser("clear"),s++,l=!0,e(".modal-hotspot-"+t).find(".cover").hide())}})}})},d=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-xp"),i=$(".room-xp"),e=i.find.bind(i),s=0;e(".modal-start .btn-start").click(function(){e(".modal-start").hide()}),e(".modal-hotspot").click(function(){$(this).hide();var t=$(this).attr("data-hotspot");window.krpanoInstance.call("set(hotspot[room-xp-light-"+t+"].visible,false);"),4===s?e(".modal-lottery").show():(e(".last-"+(4-s)).show(),setTimeout(function(){e(".last-"+(4-s)).hide()},1e3))}),e(".modal-gift .btn-book").click(function(){e(".modal-gift").hide()}),n(i),t("xp",{in:function(){o.pause(),a.play(),setTimeout(function(){e(".modal-start").show()},1e3),s=0},openHotspot:function(t){e(".modal-hotspot-"+t).show(),s++}})},p=document.getElementById("bgm-c"),g=document.getElementById("bgm-gk"),m=document.getElementById("bgm-hp"),r=document.getElementById("bgm-rsj"),c=document.getElementById("bgm-tx"),h=document.getElementById("bgm-td"),u=document.getElementById("bgm-xp");p.play(),p.pause(),document.addEventListener("WeixinJSBridgeReady",function(){p.play(),p.pause()},!1);var f=function(){function t(){f.currentTime=17}function o(){requestAnimationFrame(function(){if(f.currentTime>=25)return f.pause(),$(".page-video").addClass("opacity"),$(".page-pano").addClass("opacity").show(),setTimeout(function(){$(".page-pano").removeClass("opacity")}),setTimeout(function(){$(".page-video").hide()},320),p.play(),void(n=!0);f.currentTime>=17?f.removeEventListener("click",t):f.currentTime>=7&&f.addEventListener("click",t,{once:!0}),o()})}var n=!1,f=document.getElementById("video");f.addEventListener("click",function(){f.paused&&f.play()}),$(".orientLayer").on("touchstart",function(){return!1}),$(".startLayer").on("click",function(){$(this).hide(),$(".page-video").addClass("opacity").show(),setTimeout(function(){$(".page-video").removeClass("opacity")},20),f.play(),o()}),embedpano({swf:"tour.swf",xml:"tour.xml",target:"pano",html5:"auto",mobilescale:1,passQueryParameters:!0,consolelog:!0,onready:function(t){window.krpanoInstance=t}}),window.inCorridor=function(){g.pause(),m.pause(),r.pause(),c.pause(),h.pause(),u.pause(),n&&p.play()},a(),i(),e(),s(),l(),d()};!function(t){function n(t){console.log("error:",t)}function a(t){var o=100*e.progress;$(".loadingLayout .count").text(o.toFixed()+"%")}function i(){$(".loadingLayout").hide(),t()}if(0==o.length)return void i();var e=new createjs.LoadQueue(!1,"./assets/");e.on("error",n),e.on("progress",a),e.on("complete",i);for(var s=0;s<o.length;s++)e.loadFile(o[s])}(function(){f()})}).call(void 0);