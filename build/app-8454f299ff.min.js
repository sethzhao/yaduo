"use strict";(function(){function t(t,o){for(var n in o)window[t+"_"+n]=o[n]}var o=["gk/last-1.png","gk/last-2.png","gk/last-3.png","gk/light-1.png","gk/light-2.png","gk/light-3.png","gk/light-4.png","gk/modal-gift-1.png","gk/modal-gift-2.png","gk/modal-gift-3.png","gk/modal-gift-4.png","gk/modal-gift-5.png","gk/modal-hotspot-1.png","gk/modal-hotspot-2.png","gk/modal-hotspot-3.png","gk/modal-hotspot-4.png","gk/modal-lottery.png","gk/modal-start.png","hp/last-1.png","hp/last-2.png","hp/last-3.png","hp/light-1.png","hp/light-2.png","hp/light-3.png","hp/light-4.png","hp/modal-gift-1.png","hp/modal-gift-2.png","hp/modal-gift-3.png","hp/modal-gift-4.png","hp/modal-gift-5.png","hp/modal-hotspot-1.png","hp/modal-hotspot-2.png","hp/modal-hotspot-3.png","hp/modal-hotspot-4.png","hp/modal-lottery.png","hp/modal-start.png","right.png","rsj/last-1.png","rsj/last-2.png","rsj/last-3.png","rsj/light-1.png","rsj/light-2.png","rsj/light-3.png","rsj/light-4.png","rsj/modal-gift-1.png","rsj/modal-gift-2.png","rsj/modal-gift-3.png","rsj/modal-gift-4.png","rsj/modal-gift-5.png","rsj/modal-hotspot-1.png","rsj/modal-hotspot-2.png","rsj/modal-hotspot-3.png","rsj/modal-hotspot-4.png","rsj/modal-lottery.png","rsj/modal-start.png","td/last-1.png","td/last-2.png","td/last-3.png","td/last-4.png","td/last-5.png","td/light-by.png","td/light-sp.png","td/light-ss.png","td/light-sy.png","td/light-sz.png","td/light-tc.png","td/modal-gift-1.png","td/modal-gift-2.png","td/modal-gift-3.png","td/modal-gift-4.png","td/modal-gift-5.png","td/modal-hotspot-by.png","td/modal-hotspot-sp.png","td/modal-hotspot-ss.png","td/modal-hotspot-sy.png","td/modal-hotspot-sz.png","td/modal-hotspot-tc.png","td/modal-lottery.png","td/modal-start.png","tx/last-1.png","tx/last-2.png","tx/last-3.png","tx/light-1.png","tx/light-2.png","tx/light-3.png","tx/light-4.png","tx/modal-gift-1.png","tx/modal-gift-2.png","tx/modal-gift-3.png","tx/modal-gift-4.png","tx/modal-gift-5.png","tx/modal-hotspot-1.png","tx/modal-hotspot-2.png","tx/modal-hotspot-3.png","tx/modal-hotspot-4.png","tx/modal-lottery.png","tx/modal-start.png","tx/scratch.png","tx/tv.png","wrong.png","xp/last-1.png","xp/last-2.png","xp/last-3.png","xp/light-1.png","xp/light-2.png","xp/light-3.png","xp/light-4.png","xp/modal-gift-1.png","xp/modal-gift-2.png","xp/modal-gift-3.png","xp/modal-gift-4.png","xp/modal-gift-5.png","xp/modal-hotspot-1.png","xp/modal-hotspot-2.png","xp/modal-hotspot-3.png","xp/modal-hotspot-4.png","xp/modal-lottery.png","xp/modal-start.png"],n=function(t){function o(){if(d.addClass("active"+l),p&&(c++,g=Math.floor(n(c,50,500,r)),c==r))return p=!1,void setTimeout(function(){m=!0,e(".modal-lottery").hide(),e(".modal-gift").addClass("modal-gift-"+u).show()},1e3);setTimeout(function(){d.removeClass("active"+l),l++,5===l&&(l=0),o()},g)}function n(t,o,n,a){return n*(t/=a)*t*t*t*t+o}function a(t,o){return t>o?t-o:t<o?5-o+t:0}function i(){m&&(m=!1,p=!1,u=h=0,r=0,c=0,g=50,o())}function s(){m||p||(u=Math.floor(5*Math.random())+1,h=u-1,p=!0,r=a(h,l)+5)}var l=0,e=t.find.bind(t),d=e(".active"),g=50,p=!1,m=!0,h=0,r=0,c=0,u=0;e(".btn-lottery").click(function(){m&&(i(),setTimeout(function(){s()},2e3))})},a=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-gk"),i=$(".room-gk"),s=i.find.bind(i),l=0,e=!1;s(".modal-start .btn-start").click(function(){s(".modal-start").hide()}),s(".modal-hotspot .answer").click(function(){var t=this;if(!e){e=!0;var o=$(this).attr("data-right");o?($(this).addClass("right"),setTimeout(function(){$(t).removeClass("right"),s(".modal-hotspot").hide(),window.krpanoInstance.call("set(hotspot[room-gk-light-"+o+"].visible,false);"),l++,4===l?s(".modal-lottery").show():(s(".last-"+(4-l)).show(),setTimeout(function(){s(".last-"+(4-l)).hide(),e=!1},1e3))},1e3)):($(this).addClass("wrong"),setTimeout(function(){$(t).removeClass("wrong"),e=!1},1e3))}}),s(".modal-gift .btn-book").click(function(){s(".modal-gift").hide()}),n(i),t("gk",{in:function(){o.pause(),a.play(),setTimeout(function(){s(".modal-start").show()},1e3),l=0},openHotspot:function(t){s(".modal-hotspot-"+t).show()}})},i=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-hp"),i=$(".room-hp"),s=i.find.bind(i),l=0;s(".modal-start .btn-start").click(function(){s(".modal-start").hide()}),s(".modal-hotspot").click(function(){$(this).hide();var t=$(this).attr("data-hotspot");window.krpanoInstance.call("set(hotspot[room-hp-light-"+t+"].visible,false);"),4===l?s(".modal-lottery").show():(s(".last-"+(4-l)).show(),setTimeout(function(){s(".last-"+(4-l)).hide()},1e3))}),s(".modal-gift .btn-book").click(function(){s(".modal-gift").hide()}),n(i),t("hp",{in:function(){o.pause(),a.play(),setTimeout(function(){s(".modal-start").show()},1e3),l=0},openHotspot:function(t){s(".modal-hotspot-"+t).show(),l++}})},s=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-rsj"),i=$(".room-rsj"),s=i.find.bind(i),l=0;s(".modal-start .btn-start").click(function(){s(".modal-start").hide()}),s(".modal-hotspot").click(function(){$(this).hide();var t=$(this).attr("data-hotspot");window.krpanoInstance.call("set(hotspot[room-rsj-light-"+t+"].visible,false);"),4===l?s(".modal-lottery").show():(s(".last-"+(4-l)).show(),setTimeout(function(){s(".last-"+(4-l)).hide()},1e3))}),s(".modal-gift .btn-book").click(function(){s(".modal-gift").hide()}),n(i),t("rsj",{in:function(){o.pause(),a.play(),setTimeout(function(){s(".modal-start").show()},1e3),l=0},openHotspot:function(t){s(".modal-hotspot-"+t).show(),l++}})},l=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-td"),i=$(".room-td"),s=i.find.bind(i),l=0,e=!1;s(".modal-start .btn-start").click(function(){s(".modal-start").hide()}),s(".modal-hotspot .answer").click(function(){var t=this;if(!e){e=!0;var o=$(this).attr("data-right");o?($(this).addClass("right"),setTimeout(function(){$(t).removeClass("right"),s(".modal-hotspot").hide(),window.krpanoInstance.call("set(hotspot[room-td-light-"+o+"].visible,false);"),l++,3===l?s(".modal-lottery").show():(s(".last-"+(3-l)).show(),setTimeout(function(){s(".last-"+(3-l)).hide(),e=!1},1e3))},1e3)):($(this).addClass("wrong"),setTimeout(function(){$(t).removeClass("wrong"),e=!1},1e3))}}),s(".modal-gift .btn-book").click(function(){s(".modal-gift").hide()}),n(i),t("td",{in:function(){o.pause(),a.play(),setTimeout(function(){s(".modal-start").show()},1e3),l=0},openHotspot:function(t){s(".modal-hotspot-"+t).show()}})},e=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-tx"),i=$(".room-tx"),s=i.find.bind(i),l=0,e=!1;s(".modal-start .btn-start").click(function(){s(".modal-start").hide()}),s(".modal-hotspot").click(function(){if(e){$(this).hide();var t=$(this).attr("data-hotspot");window.krpanoInstance.call("set(hotspot[room-tx-light-"+t+"].visible,false);"),$(this).find(".cover").eraser("reset"),4===l?s(".modal-lottery").show():(s(".last-"+(4-l)).show(),setTimeout(function(){s(".last-"+(4-l)).hide()},1e3))}}),s(".modal-gift .btn-book").click(function(){s(".modal-gift").hide()}),n(i),t("tx",{in:function(){o.pause(),a.play(),setTimeout(function(){s(".modal-start").show()},1e3),l=0},openHotspot:function(t){e=!1,s(".modal-hotspot-"+t).show(),s(".modal-hotspot-"+t).find(".cover").show(),s(".modal-hotspot-"+t).find(".cover").eraser({progressFunction:function(o){Math.round(100*o)>60&&(s(".modal-hotspot-"+t).find(".cover").eraser("clear"),l++,e=!0,s(".modal-hotspot-"+t).find(".cover").hide())}})}})},d=function(){var o=document.getElementById("bgm-c"),a=document.getElementById("bgm-xp"),i=$(".room-xp"),s=i.find.bind(i),l=0;s(".modal-start .btn-start").click(function(){s(".modal-start").hide()}),s(".modal-hotspot").click(function(){$(this).hide();var t=$(this).attr("data-hotspot");window.krpanoInstance.call("set(hotspot[room-xp-light-"+t+"].visible,false);"),4===l?s(".modal-lottery").show():(s(".last-"+(4-l)).show(),setTimeout(function(){s(".last-"+(4-l)).hide()},1e3))}),s(".modal-gift .btn-book").click(function(){s(".modal-gift").hide()}),n(i),t("xp",{in:function(){o.pause(),a.play(),setTimeout(function(){s(".modal-start").show()},1e3),l=0},openHotspot:function(t){s(".modal-hotspot-"+t).show(),l++}})},g=document.getElementById("bgm-c"),p=document.getElementById("bgm-gk"),m=document.getElementById("bgm-hp"),h=document.getElementById("bgm-rsj"),r=document.getElementById("bgm-tx"),c=document.getElementById("bgm-td"),u=document.getElementById("bgm-xp");g.play(),g.pause(),document.addEventListener("WeixinJSBridgeReady",function(){g.play(),g.pause()},!1);var f=function(){var t=!1,o=document.getElementById("video");o.addEventListener("click",function(){o.paused&&o.play()}),$(".orientLayer").on("touchstart",function(){return!1}),$(".startLayer").on("click",function(){$(this).hide(),$(".page-pano").addClass("opacity").show(),setTimeout(function(){$(".page-pano").removeClass("opacity")}),g.play(),t=!0}),embedpano({swf:"tour.swf",xml:"tour.xml",target:"pano",html5:"auto",mobilescale:1,passQueryParameters:!0,consolelog:!0,onready:function(t){window.krpanoInstance=t}}),window.inCorridor=function(){p.pause(),m.pause(),h.pause(),r.pause(),c.pause(),u.pause(),t&&g.play()},a(),i(),s(),l(),e(),d()};!function(t){function n(t){console.log("error:",t)}function a(t){var o=100*s.progress;$(".loadingLayout .count").text(o.toFixed()+"%")}function i(){$(".loadingLayout").hide(),t()}if(0==o.length)return void i();var s=new createjs.LoadQueue(!1,"./assets/");s.on("error",n),s.on("progress",a),s.on("complete",i);for(var l=0;l<o.length;l++)s.loadFile(o[l])}(function(){f()})}).call(void 0);